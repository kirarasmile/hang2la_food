import{f as N,J as x,r as v,t as P,y as R,E as l,D as t,C as s,v as U,G as p,K as q}from"./index-DwCDJex0.js";import{v as w,u as I}from"./inviteCode-Cx2daP6U.js";import{e as B,N as V,v as d,d as C,B as f,_ as S}from"./_plugin-vue_export-helper-Bw40c_nT.js";import{a as T,N as n}from"./FormItem-CTHPN966.js";const D={class:"page-container"},E={class:"register-wrapper"},F=N({__name:"RegisterPage",setup(j){const c=q(),g=x(),o=B(),b=v(null),i=v(!1),m=v(!1),a=v({email:"",password:"",confirmPassword:"",nickname:"",inviteCode:""}),y={email:[{required:!0,message:"è¯·è¾“å…¥é‚®ç®±",trigger:"blur"},{type:"email",message:"è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€",trigger:["blur","change"]}],password:[{required:!0,message:"è¯·è¾“å…¥å¯†ç ",trigger:"blur"},{min:6,message:"å¯†ç è‡³å°‘6ä½",trigger:["blur","change"]}],confirmPassword:[{required:!0,message:"è¯·ç¡®è®¤å¯†ç ",trigger:"blur"},{validator:(u,e)=>e===a.value.password,message:"ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´",trigger:["blur","change"]}],nickname:[{required:!0,message:"è¯·è¾“å…¥æ˜µç§°",trigger:"blur"},{min:2,max:20,message:"æ˜µç§°é•¿åº¦ä¸º 2-20 ä¸ªå­—ç¬¦",trigger:["blur","change"]}],inviteCode:[{required:!0,message:"è¯·è¾“å…¥é‚€è¯·ç ",trigger:"blur"},{len:8,message:"é‚€è¯·ç ä¸º 8 ä½",trigger:["blur","change"]}]};async function h(){if(!a.value.inviteCode||a.value.inviteCode.length!==8){o.warning("è¯·è¾“å…¥ 8 ä½é‚€è¯·ç ");return}m.value=!0;try{const u=await w(a.value.inviteCode);u.valid?o.success("é‚€è¯·ç æœ‰æ•ˆï¼"):o.error(u.message)}finally{m.value=!1}}async function k(){var u;try{await((u=b.value)==null?void 0:u.validate())}catch{return}i.value=!0;try{const e=await w(a.value.inviteCode);if(!e.valid){o.error(e.message);return}const r=await g.signUp(a.value.email,a.value.password,a.value.nickname,a.value.inviteCode);r.success?(g.user&&await I(a.value.inviteCode,g.user.id),o.success("æ³¨å†ŒæˆåŠŸï¼è¯·æŸ¥æ”¶é‚®ç®±éªŒè¯é‚®ä»¶"),setTimeout(()=>{c.push("/login")},2e3)):o.error(r.message)}catch(e){console.error("Register error:",e),o.error(e.message||"æ³¨å†Œå¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")}finally{i.value=!1}}function _(){c.push("/login")}return(u,e)=>(U(),P("div",D,[R("div",E,[l(s(V),{title:"ðŸœ æ³¨å†Œè´¦å·",class:"register-card"},{default:t(()=>[l(s(T),{ref_key:"formRef",ref:b,model:a.value,rules:y,"label-placement":"left","label-width":"80","require-mark-placement":"right-hanging"},{default:t(()=>[l(s(n),{label:"é‚®ç®±",path:"email"},{default:t(()=>[l(s(d),{value:a.value.email,"onUpdate:value":e[0]||(e[0]=r=>a.value.email=r),placeholder:"è¯·è¾“å…¥é‚®ç®±",disabled:i.value},null,8,["value","disabled"])]),_:1}),l(s(n),{label:"å¯†ç ",path:"password"},{default:t(()=>[l(s(d),{value:a.value.password,"onUpdate:value":e[1]||(e[1]=r=>a.value.password=r),placeholder:"è‡³å°‘ 6 ä½",type:"password","show-password-on":"click",disabled:i.value},null,8,["value","disabled"])]),_:1}),l(s(n),{label:"ç¡®è®¤å¯†ç ",path:"confirmPassword"},{default:t(()=>[l(s(d),{value:a.value.confirmPassword,"onUpdate:value":e[2]||(e[2]=r=>a.value.confirmPassword=r),placeholder:"å†æ¬¡è¾“å…¥å¯†ç ",type:"password","show-password-on":"click",disabled:i.value},null,8,["value","disabled"])]),_:1}),l(s(n),{label:"æ˜µç§°",path:"nickname"},{default:t(()=>[l(s(d),{value:a.value.nickname,"onUpdate:value":e[3]||(e[3]=r=>a.value.nickname=r),placeholder:"2-20 ä¸ªå­—ç¬¦",disabled:i.value},null,8,["value","disabled"])]),_:1}),l(s(n),{label:"é‚€è¯·ç ",path:"inviteCode"},{default:t(()=>[l(s(C),{style:{width:"100%"}},{default:t(()=>[l(s(d),{value:a.value.inviteCode,"onUpdate:value":e[4]||(e[4]=r=>a.value.inviteCode=r),placeholder:"8 ä½é‚€è¯·ç ",disabled:i.value,style:{flex:"1"},onInput:e[5]||(e[5]=r=>a.value.inviteCode=a.value.inviteCode.toUpperCase())},null,8,["value","disabled"]),l(s(f),{secondary:"",loading:m.value,disabled:i.value||a.value.inviteCode.length!==8,onClick:h},{default:t(()=>[...e[6]||(e[6]=[p(" éªŒè¯ ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1}),l(s(n),null,{default:t(()=>[l(s(C),{style:{width:"100%","justify-content":"flex-end"}},{default:t(()=>[l(s(f),{disabled:i.value,onClick:_},{default:t(()=>[...e[7]||(e[7]=[p(" å·²æœ‰è´¦å·ï¼ŸåŽ»ç™»å½• ",-1)])]),_:1},8,["disabled"]),l(s(f),{type:"primary",loading:i.value,onClick:k},{default:t(()=>[...e[8]||(e[8]=[p(" æ³¨å†Œ ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])]))}}),L=S(F,[["__scopeId","data-v-ca6aef19"]]);export{L as default};
