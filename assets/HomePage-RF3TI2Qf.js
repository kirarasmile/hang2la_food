import{i as de,c as ce,a as U,b as ue,d as fe,e as A,f as Y,g as B,r as me,h as E,j as ve,V as ge,u as ee,k as N,l as J,m as P,n as W,o as he,p as te,q as pe,s as be,t as se,w as _e,v as ye,x as ke,y as ze,z as xe,A as Se,F as L,B as Q,C as g,D as u,E as re,G as a,H as K,I as _,J as M,K as r,N as $e,L as h,M as v,O as w,P as we,Q as V,R as Ce,S as Re,T as Oe,U as I}from"./index-BsbxUZYF.js";import{u as Pe,a as je,F as Le}from"./useFilter-COYxaZYb.js";import{t as Be,T as oe,C as Fe,N as ae}from"./index-CQr1Dh-D.js";import{_ as H,N as G,u as Ee}from"./_plugin-vue_export-helper-CggdVFg3.js";import{N as Ne,a as Te}from"./Dropdown-DQu2jQoN.js";import{i as He,o as Ie,S as Ae}from"./Scrollbar-CsEZbUCp.js";import"./Checkbox-C19iA5R7.js";import"./RadioGroup-Cj7KYhSQ.js";import"./Tooltip-ChEZ6kdK.js";let X=!1;function Me(){if(de&&window.CSS&&!X&&(X=!0,"registerProperty"in(window==null?void 0:window.CSS)))try{CSS.registerProperty({name:"--n-color-start",syntax:"<color>",inherits:!1,initialValue:"#0000"}),CSS.registerProperty({name:"--n-color-end",syntax:"<color>",inherits:!1,initialValue:"#0000"})}catch{}}const Ve=ce("n-avatar-group"),Ge=U("avatar",`
 width: var(--n-merged-size);
 height: var(--n-merged-size);
 color: #FFF;
 font-size: var(--n-font-size);
 display: inline-flex;
 position: relative;
 overflow: hidden;
 text-align: center;
 border: var(--n-border);
 border-radius: var(--n-border-radius);
 --n-merged-color: var(--n-color);
 background-color: var(--n-merged-color);
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
`,[ue(A("&","--n-merged-color: var(--n-color-modal);")),fe(A("&","--n-merged-color: var(--n-color-popover);")),A("img",`
 width: 100%;
 height: 100%;
 `),Y("text",`
 white-space: nowrap;
 display: inline-block;
 position: absolute;
 left: 50%;
 top: 50%;
 `),U("icon",`
 vertical-align: bottom;
 font-size: calc(var(--n-merged-size) - 6px);
 `),Y("text","line-height: 1.25")]),We=Object.assign(Object.assign({},W.props),{size:[String,Number],src:String,circle:{type:Boolean,default:void 0},objectFit:String,round:{type:Boolean,default:void 0},bordered:{type:Boolean,default:void 0},onError:Function,fallbackSrc:String,intersectionObserverOptions:Object,lazy:Boolean,onLoad:Function,renderPlaceholder:Function,renderFallback:Function,imgProps:Object,color:String}),Ke=B({name:"Avatar",props:We,slots:Object,setup(e){const{mergedClsPrefixRef:n,inlineThemeDisabled:o}=ee(e),i=N(!1);let c=null;const f=N(null),l=N(null),k=()=>{const{value:t}=f;if(t&&(c===null||c!==t.innerHTML)){c=t.innerHTML;const{value:d}=l;if(d){const{offsetWidth:m,offsetHeight:b}=d,{offsetWidth:z,offsetHeight:T}=t,F=.9,D=Math.min(m/z*F,b/T*F,1);t.style.transform=`translateX(-50%) translateY(-50%) scale(${D})`}}},C=J(Ve,null),S=P(()=>{const{size:t}=e;if(t)return t;const{size:d}=C||{};return d||"medium"}),R=W("Avatar","-avatar",Ge,he,e,n),$=J(Be,null),x=P(()=>{if(C)return!0;const{round:t,circle:d}=e;return t!==void 0||d!==void 0?t||d:$?$.roundRef.value:!1}),O=P(()=>C?!0:e.bordered||!1),y=P(()=>{const t=S.value,d=x.value,m=O.value,{color:b}=e,{self:{borderRadius:z,fontSize:T,color:F,border:D,colorModal:ne,colorPopover:ie},common:{cubicBezierEaseInOut:le}}=R.value;let q;return typeof t=="number"?q=`${t}px`:q=R.value.self[te("height",t)],{"--n-font-size":T,"--n-border":m?D:"none","--n-border-radius":d?"50%":z,"--n-color":b||F,"--n-color-modal":b||ne,"--n-color-popover":b||ie,"--n-bezier":le,"--n-merged-size":`var(--n-avatar-size-override, ${q})`}}),s=o?pe("avatar",P(()=>{const t=S.value,d=x.value,m=O.value,{color:b}=e;let z="";return t&&(typeof t=="number"?z+=`a${t}`:z+=t[0]),d&&(z+="b"),m&&(z+="c"),b&&(z+=be(b)),z}),y,e):void 0,p=N(!e.lazy);se(()=>{if(e.lazy&&e.intersectionObserverOptions){let t;const d=_e(()=>{t==null||t(),t=void 0,e.lazy&&(t=Ie(l.value,e.intersectionObserverOptions,p))});ye(()=>{d(),t==null||t()})}}),ke(()=>{var t;return e.src||((t=e.imgProps)===null||t===void 0?void 0:t.src)},()=>{i.value=!1});const j=N(!e.lazy);return{textRef:f,selfRef:l,mergedRoundRef:x,mergedClsPrefix:n,fitTextTransform:k,cssVars:o?void 0:y,themeClass:s==null?void 0:s.themeClass,onRender:s==null?void 0:s.onRender,hasLoadError:i,shouldStartLoading:p,loaded:j,mergedOnError:t=>{if(!p.value)return;i.value=!0;const{onError:d,imgProps:{onError:m}={}}=e;d==null||d(t),m==null||m(t)},mergedOnLoad:t=>{const{onLoad:d,imgProps:{onLoad:m}={}}=e;d==null||d(t),m==null||m(t),j.value=!0}}},render(){var e,n;const{$slots:o,src:i,mergedClsPrefix:c,lazy:f,onRender:l,loaded:k,hasLoadError:C,imgProps:S={}}=this;l==null||l();let R;const $=!k&&!C&&(this.renderPlaceholder?this.renderPlaceholder():(n=(e=this.$slots).placeholder)===null||n===void 0?void 0:n.call(e));return this.hasLoadError?R=this.renderFallback?this.renderFallback():me(o.fallback,()=>[E("img",{src:this.fallbackSrc,style:{objectFit:this.objectFit}})]):R=ve(o.default,x=>{if(x)return E(ge,{onResize:this.fitTextTransform},{default:()=>E("span",{ref:"textRef",class:`${c}-avatar__text`},x)});if(i||S.src){const O=this.src||S.src;return E("img",Object.assign(Object.assign({},S),{loading:He&&!this.intersectionObserverOptions&&f?"lazy":"eager",src:f&&this.intersectionObserverOptions?this.shouldStartLoading?O:void 0:O,"data-image-src":O,onLoad:this.mergedOnLoad,onError:this.mergedOnError,style:[S.style||"",{objectFit:this.objectFit},$?{height:"0",width:"0",visibility:"hidden",position:"absolute"}:""]}))}}),E("span",{ref:"selfRef",class:[`${c}-avatar`,this.themeClass],style:this.cssVars},R,f&&$)}});function De(e){const{heightSmall:n,heightMedium:o,heightLarge:i,borderRadius:c}=e;return{color:"#eee",colorEnd:"#ddd",borderRadius:c,heightSmall:n,heightMedium:o,heightLarge:i}}const qe={common:ze,self:De},Ue=A([U("skeleton",`
 height: 1em;
 width: 100%;
 transition:
 --n-color-start .3s var(--n-bezier),
 --n-color-end .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 animation: 2s skeleton-loading infinite cubic-bezier(0.36, 0, 0.64, 1);
 background-color: var(--n-color-start);
 `),A("@keyframes skeleton-loading",`
 0% {
 background: var(--n-color-start);
 }
 40% {
 background: var(--n-color-end);
 }
 80% {
 background: var(--n-color-start);
 }
 100% {
 background: var(--n-color-start);
 }
 `)]),Ye=Object.assign(Object.assign({},W.props),{text:Boolean,round:Boolean,circle:Boolean,height:[String,Number],width:[String,Number],size:String,repeat:{type:Number,default:1},animated:{type:Boolean,default:!0},sharp:{type:Boolean,default:!0}}),Z=B({name:"Skeleton",inheritAttrs:!1,props:Ye,setup(e){Me();const{mergedClsPrefixRef:n}=ee(e),o=W("Skeleton","-skeleton",Ue,qe,e,n);return{mergedClsPrefix:n,style:P(()=>{var i,c;const f=o.value,{common:{cubicBezierEaseInOut:l}}=f,k=f.self,{color:C,colorEnd:S,borderRadius:R}=k;let $;const{circle:x,sharp:O,round:y,width:s,height:p,size:j,text:t,animated:d}=e;j!==void 0&&($=k[te("height",j)]);const m=x?(i=s??p)!==null&&i!==void 0?i:$:s,b=(c=x?s??p:p)!==null&&c!==void 0?c:$;return{display:t?"inline-block":"",verticalAlign:t?"-0.125em":"",borderRadius:x?"50%":y?"4096px":O?"":R,width:typeof m=="number"?Q(m):m,height:typeof b=="number"?Q(b):b,animation:d?"":"none","--n-bezier":l,"--n-color-start":C,"--n-color-end":S}})}},render(){const{repeat:e,style:n,mergedClsPrefix:o,$attrs:i}=this,c=E("div",xe({class:`${o}-skeleton`,style:n},i));return e>1?E(L,null,Se(e,null).map(f=>[c,`
`])):c}}),Je={class:"label-content"},Qe={class:"tier-emoji"},Xe={class:"tier-text"},Ze={key:0,class:"shine-effect"},et=B({__name:"TierLabel",props:{tier:{}},setup(e){const n=e,o=P(()=>oe[n.tier]);return(i,c)=>(u(),g("div",{class:re(["tier-label-container",`tier-${e.tier}`])},[a("div",Je,[a("span",Qe,_(o.value.emoji),1),a("span",Xe,_(o.value.label),1)]),e.tier==="hang"?(u(),g("div",Ze)):K("",!0)],2))}}),tt=H(et,[["__scopeId","data-v-9c8e1b31"]]),st={key:0,class:"card-image"},rt=["src","alt"],ot={class:"placeholder-emoji"},at={class:"card-content-wrapper"},nt={class:"card-header"},it={class:"card-name"},lt={class:"info-row"},dt={class:"info-item"},ct={class:"info-icon"},ut={class:"info-item price"},ft={class:"info-row location"},mt={class:"address-text"},vt={key:0,class:"recommendation-box"},gt=B({__name:"RestaurantCard",props:{restaurant:{}},setup(e){const n=e,o=oe[n.restaurant.tier],i=Fe[n.restaurant.category],c=P(()=>({background:`linear-gradient(135deg, ${o.color}1a 0%, ${o.color}33 100%)`,borderBottom:`2px solid ${o.color}`}));return(f,l)=>(u(),M(r($e),{class:"restaurant-card",hoverable:"",bordered:!1},{cover:h(()=>[e.restaurant.image_url?(u(),g("div",st,[a("img",{src:e.restaurant.image_url,alt:e.restaurant.name,loading:"lazy"},null,8,rt),l[0]||(l[0]=a("div",{class:"image-overlay"},null,-1))])):(u(),g("div",{key:1,class:"card-image-placeholder",style:we(c.value)},[a("span",ot,_(r(i).emoji),1)],4))]),default:h(()=>[a("div",at,[a("div",nt,[a("h3",it,_(e.restaurant.name),1),v(r(ae),{color:{color:r(o).color+"1a",textColor:r(o).color,borderColor:r(o).color},bordered:!0,round:"",size:"small",class:"tier-tag"},{default:h(()=>[w(_(r(o).emoji)+" "+_(r(o).label),1)]),_:1},8,["color"])]),v(r(G),{vertical:"",size:6,class:"card-details"},{default:h(()=>[a("div",lt,[a("span",dt,[a("span",ct,_(r(i).emoji),1),w(" "+_(r(i).label),1)]),l[1]||(l[1]=a("span",{class:"separator"},"â€¢",-1)),a("span",ut," Â¥"+_(e.restaurant.price_per_person)+"/äºº ",1)]),a("div",ft,[l[2]||(l[2]=a("span",{class:"info-icon"},"ðŸ“",-1)),a("span",mt,_(e.restaurant.address),1)]),e.restaurant.recommendation?(u(),g("div",vt,[l[3]||(l[3]=a("span",{class:"quote-icon"},"â",-1)),v(r(Ne),{"line-clamp":2,tooltip:!1},{default:h(()=>[w(_(e.restaurant.recommendation),1)]),_:1})])):K("",!0)]),_:1})])]),_:1}))}}),ht=H(gt,[["__scopeId","data-v-4b7eece9"]]),pt={class:"tier-content"},bt={class:"card-list"},_t=B({__name:"TierRow",props:{tier:{},restaurants:{}},setup(e){return(n,o)=>(u(),g("div",{class:re(["tier-row",`tier-row-${e.tier}`])},[v(tt,{tier:e.tier},null,8,["tier"]),a("div",pt,[v(r(Ae),{"x-scrollable":""},{default:h(()=>[a("div",bt,[(u(!0),g(L,null,V(e.restaurants,i=>(u(),M(ht,{key:i.id,restaurant:i,class:"stagger-item"},null,8,["restaurant"]))),128))])]),_:1})])],2))}}),yt=H(_t,[["__scopeId","data-v-b6efc8ee"]]),kt={class:"tier-board"},zt={key:1,class:"global-empty-state"},xt=B({__name:"TierBoard",props:{restaurants:{}},setup(e){const n=e,o=P(()=>{const f={hang:[],top:[],elite:[],npc:[],la:[]};return n.restaurants.forEach(l=>{l.is_deleted||f[l.tier].push(l)}),f}),i=["hang","top","elite","npc","la"],c=P(()=>n.restaurants.length>0&&n.restaurants.some(f=>!f.is_deleted));return(f,l)=>(u(),g("div",kt,[c.value?(u(),g(L,{key:0},V(i,k=>(u(),g(L,{key:k},[o.value[k].length>0?(u(),M(yt,{key:0,tier:k,restaurants:o.value[k]},null,8,["tier","restaurants"])):K("",!0)],64))),64)):(u(),g("div",zt,[...l[0]||(l[0]=[a("div",{class:"empty-content"},[a("span",{class:"empty-emoji"},"ðŸ½ï¸"),a("h3",null,"æš‚æ— ç¬¦åˆæ¡ä»¶çš„é¤åŽ…"),a("p",null,"æ¢ä¸ªç­›é€‰æ¡ä»¶è¯•è¯•ï¼Ÿ")],-1)])]))]))}}),St=H(xt,[["__scopeId","data-v-357695bb"]]),$t={class:"loading-skeleton"},wt=B({__name:"LoadingSkeleton",setup(e){return(n,o)=>(u(),g("div",$t,[(u(),g(L,null,V(5,i=>a("div",{key:i,class:"skeleton-tier-row"},[v(r(Z),{height:"200px",width:"120px"}),v(r(G),{class:"skeleton-cards"},{default:h(()=>[(u(),g(L,null,V(3,c=>v(r(Z),{key:c,height:"200px",width:"280px"})),64))]),_:1})])),64))]))}}),Ct=H(wt,[["__scopeId","data-v-e917af04"]]),Rt={class:"home-page"},Ot={class:"page-header"},Pt={class:"header-content"},jt={class:"user-avatar-wrapper"},Lt={class:"user-nickname"},Bt={class:"filter-sticky-wrapper"},Ft={key:0,class:"filter-stats"},Et={class:"content"},Nt=B({__name:"HomePage",setup(e){const n=Oe(),o=Ce(),i=Ee(),c=N(!0),f=Pe(),l=N([]);se(async()=>{o.initialized||await o.initialize(),await k()});async function k(){c.value=!0;try{const{data:y,error:s}=await Re.from("restaurants").select("*").eq("is_deleted",!1).order("created_at",{ascending:!1});if(s)throw s;y&&y.length>0?(l.value=y,console.log("[HomePage] Loaded",y.length,"restaurants from database")):(console.log("[HomePage] No restaurants in database"),l.value=[])}catch(y){console.error("[HomePage] Failed to fetch restaurants:",y.message),i.error("åŠ è½½æ•°æ®å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•"),l.value=[]}finally{c.value=!1}}const C=[{label:"ä¸ªäººè®¾ç½®",key:"profile"},{label:"é€€å‡ºç™»å½•",key:"logout"}],S=[{label:"ç®¡ç†åŽå°",key:"admin"},{type:"divider",key:"d1"},...C];async function R(y){switch(y){case"logout":const s=await o.signOut();s.success?(i.success("å·²é€€å‡ºç™»å½•"),n.push("/login")):i.error(s.message);break;case"admin":n.push("/admin");break;case"profile":i.info("ä¸ªäººè®¾ç½®åŠŸèƒ½å³å°†ä¸Šçº¿");break}}const{filteredRestaurants:$,filteredCount:x,totalCount:O}=je(l);return(y,s)=>(u(),g("div",Rt,[a("header",Ot,[a("div",Pt,[s[9]||(s[9]=a("h1",{class:"page-title"},[a("span",{class:"title-emoji"},"ðŸœ"),w(" ç¾Žé£Ÿä»Žå¤¯åˆ°æ‹‰æŽ’è¡Œæ¦œ ")],-1)),v(r(G),null,{default:h(()=>[r(o).isAuthenticated?(u(),g(L,{key:1},[v(r(I),{type:"primary",onClick:s[2]||(s[2]=p=>r(n).push("/submit"))},{default:h(()=>[...s[7]||(s[7]=[w(" âœï¸ å½•å…¥ç¾Žé£Ÿ ",-1)])]),_:1}),v(r(I),{onClick:s[3]||(s[3]=p=>r(n).push("/map"))},{default:h(()=>[...s[8]||(s[8]=[w(" ðŸ—ºï¸ åœ°å›¾æ¨¡å¼ ",-1)])]),_:1}),v(r(Te),{options:r(o).isAdmin?S:C,onSelect:R},{default:h(()=>{var p,j,t,d,m;return[a("div",jt,[v(r(Ke),{round:"",size:"medium",src:(p=r(o).profile)==null?void 0:p.avatar_url,"fallback-src":"https://api.dicebear.com/7.x/avataaars/svg?seed="+((j=r(o).user)==null?void 0:j.email)},{default:h(()=>{var b,z,T,F;return[w(_(((z=(b=r(o).profile)==null?void 0:b.nickname)==null?void 0:z.charAt(0))||((F=(T=r(o).user)==null?void 0:T.email)==null?void 0:F.charAt(0))),1)]}),_:1},8,["src","fallback-src"]),a("span",Lt,_(((t=r(o).profile)==null?void 0:t.nickname)||((m=(d=r(o).user)==null?void 0:d.email)==null?void 0:m.split("@")[0])),1)])]}),_:1},8,["options"])],64)):(u(),g(L,{key:0},[v(r(I),{onClick:s[0]||(s[0]=p=>r(n).push("/login"))},{default:h(()=>[...s[5]||(s[5]=[w(" ç™»å½• ",-1)])]),_:1}),v(r(I),{type:"primary",onClick:s[1]||(s[1]=p=>r(n).push("/register"))},{default:h(()=>[...s[6]||(s[6]=[w(" æ³¨å†Œ ",-1)])]),_:1})],64))]),_:1})])]),a("div",Bt,[v(Le)]),r(f).hasActiveFilters()?(u(),g("div",Ft,[v(r(G),{align:"center"},{default:h(()=>[v(r(ae),{type:"info",size:"medium"},{default:h(()=>[w(" å·²ç­›é€‰: "+_(r(x))+" / "+_(r(O))+" å®¶ ",1)]),_:1}),v(r(I),{size:"small",secondary:"",onClick:s[4]||(s[4]=p=>r(f).resetFilters())},{default:h(()=>[...s[10]||(s[10]=[w(" ðŸ”„ æ¸…ç©ºç­›é€‰ ",-1)])]),_:1})]),_:1})])):K("",!0),a("div",Et,[c.value?(u(),M(Ct,{key:0})):(u(),M(St,{key:1,restaurants:r($)},null,8,["restaurants"]))])]))}}),Dt=H(Nt,[["__scopeId","data-v-f54911de"]]);export{Dt as default};
