import{a as M,aZ as B,_ as C,g as T,h,b1 as E,n as S,bu as D,k as p,m as x,bv as j,z as L,M as I,K as P,N as $,bn as H,D as y,C as V,H as q,J as z,P as A}from"./index-DSWyEqkt.js";import{N as F,R as J}from"./RestaurantForm-Ds4x8D5O.js";import{u as K,_ as U}from"./_plugin-vue_export-helper-DcEv8ckT.js";const Z=M("ellipsis",{overflow:"hidden"},[B("line-clamp",`
 white-space: nowrap;
 display: inline-block;
 vertical-align: bottom;
 max-width: 100%;
 `),C("line-clamp",`
 display: -webkit-inline-box;
 -webkit-box-orient: vertical;
 `),C("cursor-pointer",`
 cursor: pointer;
 `)]);function k(t){return`${t}-ellipsis--line-clamp`}function R(t,l){return`${t}-ellipsis--cursor-${l}`}const G=Object.assign(Object.assign({},S.props),{expandTrigger:String,lineClamp:[Number,String],tooltip:{type:[Boolean,Object],default:!0}}),te=T({name:"Ellipsis",inheritAttrs:!1,props:G,slots:Object,setup(t,{slots:l,attrs:o}){const a=E(),r=S("Ellipsis","-ellipsis",Z,D,t,a),d=p(null),m=p(null),f=p(null),c=p(!1),i=x(()=>{const{lineClamp:e}=t,{value:s}=c;return e!==void 0?{textOverflow:"","-webkit-line-clamp":s?"":e}:{textOverflow:s?"":"ellipsis","-webkit-line-clamp":""}});function g(){let e=!1;const{value:s}=c;if(s)return!0;const{value:n}=d;if(n){const{lineClamp:u}=t;if(_(n),u!==void 0)e=n.scrollHeight<=n.offsetHeight;else{const{value:b}=m;b&&(e=b.getBoundingClientRect().width<=n.getBoundingClientRect().width)}N(n,e)}return e}const w=x(()=>t.expandTrigger==="click"?()=>{var e;const{value:s}=c;s&&((e=f.value)===null||e===void 0||e.setShow(!1)),c.value=!s}:void 0);j(()=>{var e;t.tooltip&&((e=f.value)===null||e===void 0||e.setShow(!1))});const O=()=>h("span",Object.assign({},L(o,{class:[`${a.value}-ellipsis`,t.lineClamp!==void 0?k(a.value):void 0,t.expandTrigger==="click"?R(a.value,"pointer"):void 0],style:i.value}),{ref:"triggerRef",onClick:w.value,onMouseenter:t.expandTrigger==="click"?g:void 0}),t.lineClamp?l:h("span",{ref:"triggerInnerRef"},l));function _(e){if(!e)return;const s=i.value,n=k(a.value);t.lineClamp!==void 0?v(e,n,"add"):v(e,n,"remove");for(const u in s)e.style[u]!==s[u]&&(e.style[u]=s[u])}function N(e,s){const n=R(a.value,"pointer");t.expandTrigger==="click"&&!s?v(e,n,"add"):v(e,n,"remove")}function v(e,s,n){n==="add"?e.classList.contains(s)||e.classList.add(s):e.classList.contains(s)&&e.classList.remove(s)}return{mergedTheme:r,triggerRef:d,triggerInnerRef:m,tooltipRef:f,handleClick:w,renderTrigger:O,getTooltipDisabled:g}},render(){var t;const{tooltip:l,renderTrigger:o,$slots:a}=this;if(l){const{mergedTheme:r}=this;return h(F,Object.assign({ref:"tooltipRef",placement:"top"},l,{getDisabled:this.getTooltipDisabled,theme:r.peers.Tooltip,themeOverrides:r.peerOverrides.Tooltip}),{trigger:o,default:(t=a.tooltip)!==null&&t!==void 0?t:a.default})}else return o()}}),Q={key:0},W=T({__name:"EditRestaurantModal",props:{show:{type:Boolean},restaurant:{}},emits:["update:show","success"],setup(t,{emit:l}){const o=t,a=l,r=K(),d=p(!1);async function m(c){if(o.restaurant){d.value=!0;try{const{error:i}=await A.from("restaurants").update({...c,updated_at:new Date().toISOString()}).eq("id",o.restaurant.id);if(i)throw i;r.success("修改成功"),a("success"),a("update:show",!1)}catch(i){r.error("修改失败: "+i.message)}finally{d.value=!1}}}function f(){a("update:show",!1)}return(c,i)=>(y(),I($(H),{show:t.show,"onUpdate:show":i[0]||(i[0]=g=>a("update:show",g)),preset:"card",title:"编辑餐厅信息",style:{"max-width":"800px","max-height":"90vh","overflow-y":"auto"},class:"edit-modal"},{default:P(()=>[t.restaurant?(y(),V("div",Q,[z(J,{"initial-data":t.restaurant,onSubmit:m,onCancel:f},null,8,["initial-data"])])):q("",!0)]),_:1},8,["show"]))}}),se=U(W,[["__scopeId","data-v-589b9c26"]]);export{se as E,te as N,R as a,k as c,G as e,Z as s};
