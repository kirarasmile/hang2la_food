import{g as w,h as g,a as M,az as N,_ as x,b2 as B,n as T,bv as E,k as m,m as y,bw as j,z as I,M as P,K as $,N as H,bo as z,D as k,C as V,H as q,J as A,P as F}from"./index-Dw1eNV4X.js";import{N as J,R as K}from"./RestaurantForm-4RYZIiin.js";import{u as U,_ as Z}from"./_plugin-vue_export-helper-DDqMo13N.js";const te=w({name:"ChevronRight",render(){return g("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},g("path",{d:"M5.64645 3.14645C5.45118 3.34171 5.45118 3.65829 5.64645 3.85355L9.79289 8L5.64645 12.1464C5.45118 12.3417 5.45118 12.6583 5.64645 12.8536C5.84171 13.0488 6.15829 13.0488 6.35355 12.8536L10.8536 8.35355C11.0488 8.15829 11.0488 7.84171 10.8536 7.64645L6.35355 3.14645C6.15829 2.95118 5.84171 2.95118 5.64645 3.14645Z",fill:"currentColor"}))}}),G=M("ellipsis",{overflow:"hidden"},[N("line-clamp",`
 white-space: nowrap;
 display: inline-block;
 vertical-align: bottom;
 max-width: 100%;
 `),x("line-clamp",`
 display: -webkit-inline-box;
 -webkit-box-orient: vertical;
 `),x("cursor-pointer",`
 cursor: pointer;
 `)]);function R(t){return`${t}-ellipsis--line-clamp`}function _(t,l){return`${t}-ellipsis--cursor-${l}`}const Q=Object.assign(Object.assign({},T.props),{expandTrigger:String,lineClamp:[Number,String],tooltip:{type:[Boolean,Object],default:!0}}),se=w({name:"Ellipsis",inheritAttrs:!1,props:Q,slots:Object,setup(t,{slots:l,attrs:o}){const i=B(),c=T("Ellipsis","-ellipsis",G,E,t,i),p=m(null),v=m(null),f=m(null),n=m(!1),r=y(()=>{const{lineClamp:e}=t,{value:s}=n;return e!==void 0?{textOverflow:"","-webkit-line-clamp":s?"":e}:{textOverflow:s?"":"ellipsis","-webkit-line-clamp":""}});function d(){let e=!1;const{value:s}=n;if(s)return!0;const{value:a}=p;if(a){const{lineClamp:u}=t;if(O(a),u!==void 0)e=a.scrollHeight<=a.offsetHeight;else{const{value:b}=v;b&&(e=b.getBoundingClientRect().width<=a.getBoundingClientRect().width)}L(a,e)}return e}const C=y(()=>t.expandTrigger==="click"?()=>{var e;const{value:s}=n;s&&((e=f.value)===null||e===void 0||e.setShow(!1)),n.value=!s}:void 0);j(()=>{var e;t.tooltip&&((e=f.value)===null||e===void 0||e.setShow(!1))});const S=()=>g("span",Object.assign({},I(o,{class:[`${i.value}-ellipsis`,t.lineClamp!==void 0?R(i.value):void 0,t.expandTrigger==="click"?_(i.value,"pointer"):void 0],style:r.value}),{ref:"triggerRef",onClick:C.value,onMouseenter:t.expandTrigger==="click"?d:void 0}),t.lineClamp?l:g("span",{ref:"triggerInnerRef"},l));function O(e){if(!e)return;const s=r.value,a=R(i.value);t.lineClamp!==void 0?h(e,a,"add"):h(e,a,"remove");for(const u in s)e.style[u]!==s[u]&&(e.style[u]=s[u])}function L(e,s){const a=_(i.value,"pointer");t.expandTrigger==="click"&&!s?h(e,a,"add"):h(e,a,"remove")}function h(e,s,a){a==="add"?e.classList.contains(s)||e.classList.add(s):e.classList.contains(s)&&e.classList.remove(s)}return{mergedTheme:c,triggerRef:p,triggerInnerRef:v,tooltipRef:f,handleClick:C,renderTrigger:S,getTooltipDisabled:d}},render(){var t;const{tooltip:l,renderTrigger:o,$slots:i}=this;if(l){const{mergedTheme:c}=this;return g(J,Object.assign({ref:"tooltipRef",placement:"top"},l,{getDisabled:this.getTooltipDisabled,theme:c.peers.Tooltip,themeOverrides:c.peerOverrides.Tooltip}),{trigger:o,default:(t=i.tooltip)!==null&&t!==void 0?t:i.default})}else return o()}}),W={key:0},X=w({__name:"EditRestaurantModal",props:{show:{type:Boolean},restaurant:{}},emits:["update:show","success"],setup(t,{emit:l}){const o=t,i=l,c=U(),p=m(!1);async function v(n){if(o.restaurant){p.value=!0;try{const r={name:n.name,tier:n.tier,category:n.category,price_per_person:n.price_per_person,address:n.address,city:n.city,district:n.district,latitude:n.latitude,longitude:n.longitude,recommendation:n.recommendation,image_url:n.image_url,updated_at:new Date().toISOString()},{error:d}=await F.from("restaurants").update(r).eq("id",o.restaurant.id);if(d)throw d;c.success("修改成功"),i("success"),i("update:show",!1)}catch(r){c.error("修改失败: "+r.message)}finally{p.value=!1}}}function f(){i("update:show",!1)}return(n,r)=>(k(),P(H(z),{show:t.show,"onUpdate:show":r[0]||(r[0]=d=>i("update:show",d)),preset:"card",title:"编辑餐厅信息",style:{"max-width":"800px","max-height":"90vh","overflow-y":"auto"},class:"edit-modal"},{default:$(()=>[t.restaurant?(k(),V("div",W,[A(K,{"initial-data":t.restaurant,onSubmit:v,onCancel:f},null,8,["initial-data"])])):q("",!0)]),_:1},8,["show"]))}}),ne=Z(X,[["__scopeId","data-v-19c5760a"]]);export{te as C,ne as E,se as N,_ as a,R as c,Q as e,G as s};
